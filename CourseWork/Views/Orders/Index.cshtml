@model OrderViewModel

@{
    ViewData["Title"] = "Заказы";
}


<p>
    <a asp-action="Create">Добавить</a>
</p>
<form method="get" class="filter-form">
    <div class="form-line w-25">
        <div class="form-line">
            <label class="control-label">Сотрудник:</label>
            @Html.DropDownList("selectedEmployeeIndex", Model.ItemsFilter.EmployeesFilter, new {@class = "form-control"})
        </div>
        <br>
        <div class="form-line">
            <label class="control-label">Количество блюд:</label>
            <input name="dishCount" class="form-control" type="number" min="0" value="@Model.ItemsFilter.DishCountFilter"/>
        </div>
        <br>
        <div class="form-line">
            <label class="control-label">Блюдо: </label>
            @Html.DropDownList("selectedDishIndex", Model.ItemsFilter.DishesFilter, new {@class = "form-control"})
        </div>
        <br>
        <div class="form-line">
            <label class="control-label">Тип оплаты: </label>
            @Html.DropDownList("selectedPaymentTypeIndex", Model.ItemsFilter.PaymentTypesFilter, new {@class = "form-control"})
        </div>
        <br>
        <div class="form-line">
            <input type="submit" value="Поиск" class="btn btn-primary w-100"/>
        </div>
        <br>
    </div>
</form>
<table class="table">
<thead>
<tr>
    <th>
        <a asp-action="Index"
           asp-route-sort="@Model.ItemsSort.DateSort"
           asp-route-page="@Model.PageViewModel.PageNumber"
           asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
           asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
           asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
           asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex">
            @if (Model.ItemsSort.Current == Order.Sort.DateAsc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
                </svg>
            }
            else if (Model.ItemsSort.Current == Order.Sort.DateDesc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/>
                </svg>
            }
            @Html.DisplayNameFor(model => model.Items.FirstOrDefault().Date)
        </a>
    </th>
    <th>
        <a asp-action="Index"
           asp-route-sort="@Model.ItemsSort.TimeSort"
           asp-route-page="@Model.PageViewModel.PageNumber"
           asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
           asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
           asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
           asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex">
            @if (Model.ItemsSort.Current == Order.Sort.TimeAsc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
                </svg>
            }
            else if (Model.ItemsSort.Current == Order.Sort.TimeDesc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/>
                </svg>
            }
            @Html.DisplayNameFor(model => model.Items.FirstOrDefault().Time)
        </a>
    </th>
    <th>
        <a asp-action="Index"
           asp-route-sort="@Model.ItemsSort.CostSort"
           asp-route-page="@Model.PageViewModel.PageNumber"
           asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
           asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
           asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
           asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex">
            @if (Model.ItemsSort.Current == Order.Sort.CostAsc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
                </svg>
            }
            else if (Model.ItemsSort.Current == Order.Sort.CostDesc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/>
                </svg>
            }
            @Html.DisplayNameFor(model => model.Items.FirstOrDefault().Cost)
        </a>
    </th>
    <th>
        <a asp-action="Index"
           asp-route-sort="@Model.ItemsSort.PaymentSort"
           asp-route-page="@Model.PageViewModel.PageNumber"
           asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
           asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
           asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
           asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex">
            @if (Model.ItemsSort.Current == Order.Sort.PaymentAsc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
                </svg>
            }
            else if (Model.ItemsSort.Current == Order.Sort.PaymentDesc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/>
                </svg>
            }
            @Html.DisplayNameFor(model => model.Items.FirstOrDefault().Payment)
        </a>
    </th>
    <th>
        <a asp-action="Index"
           asp-route-sort="@Model.ItemsSort.CompletedSort"
           asp-route-page="@Model.PageViewModel.PageNumber"
           asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
           asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
           asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
           asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex">
            @if (Model.ItemsSort.Current == Order.Sort.CompletedAsc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
                </svg>
            }
            else if (Model.ItemsSort.Current == Order.Sort.CompletedDesc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/>
                </svg>
            }
            @Html.DisplayNameFor(model => model.Items.FirstOrDefault().Completed)
        </a>
    </th>
    <th>
        <a asp-action="Index"
           asp-route-sort="@Model.ItemsSort.CustomerSort"
           asp-route-page="@Model.PageViewModel.PageNumber"
           asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
           asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
           asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
           asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex">
            @if (Model.ItemsSort.Current == Order.Sort.CustomerAsc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
                </svg>
            }
            else if (Model.ItemsSort.Current == Order.Sort.CustomerDesc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/>
                </svg>
            }
            Заказчик
        </a>
    </th>
    <th>
        <a asp-action="Index"
           asp-route-sort="@Model.ItemsSort.EmployeeSort"
           asp-route-page="@Model.PageViewModel.PageNumber"
           asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
           asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
           asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
           asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex">
            @if (Model.ItemsSort.Current == Order.Sort.EmployeeAsc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
                </svg>
            }
            else if (Model.ItemsSort.Current == Order.Sort.EmployeeDesc)
            {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/>
                </svg>
            }
            Сотрудник
        </a>
    </th>
    <th></th>
</tr>
</thead>
<tbody>
@foreach (var item in Model.Items)
{
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Date)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Time)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Cost)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Payment)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Completed)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Customer.FullName)
            <a asp-controller="Customers" asp-action="Details" asp-route-id="@item.CustomerId">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/>
                </svg>
            </a>
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Employee.FullName)
            <a asp-controller="Employees" asp-action="Details" asp-route-id="@item.EmployeeId">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/>
                </svg>
            </a>
        </td>
        <td>
            <a asp-action="Edit" asp-route-id="@item.Id" title="Редактировать">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                </svg>
            </a>|
            <a asp-action="Details" asp-route-id="@item.Id" title="Подробнее">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0z" fill="none"/><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                </svg>
            </a>|
            <a asp-action="Delete" asp-route-id="@item.Id" title="Удалить">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px">
                    <path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z"/>
                </svg>
            </a>
        </td>
    </tr>
}
</tbody>
</table>

<nav>
    <ul class="pagination">
        @if (Model.PageViewModel.HasSecondPreviousPage)
        {
            <li class="page-item">
                <a asp-action="Index"
                   asp-route-sort="@Model.ItemsSort.Current"
                   asp-route-page="@(Model.PageViewModel.SecondPreviousPageNumber)"
                   asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
                   asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
                   asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
                   asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex"
                   class="page-link">
                    @(Model.PageViewModel.SecondPreviousPageNumber)
                </a>
            </li>
        }
        @if (Model.PageViewModel.HasPreviousPage)
        {
            <li class="page-item">
                <a asp-action="Index"
                   asp-route-sort="@Model.ItemsSort.Current"
                   asp-route-page="@(Model.PageViewModel.PreviousPageNumber)"
                   asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
                   asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
                   asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
                   asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex"
                   class="page-link">
                    @(Model.PageViewModel.PreviousPageNumber)
                </a>
            </li>
        }
        <li class="active page-item">
            <a class="page-link ">
                @(Model.PageViewModel.PageNumber)
            </a>
        </li>
        @if (Model.PageViewModel.HasNextPage)
        {
            <li class="page-item">
                <a asp-action="Index"
                   asp-route-sort="@Model.ItemsSort.Current"
                   asp-route-page="@(Model.PageViewModel.NextPageNumber)"
                   asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
                   asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
                   asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
                   asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex"
                   class="page-link">
                    @(Model.PageViewModel.NextPageNumber)
                </a>
            </li>
        }
        @if (Model.PageViewModel.HasSecondNextPage)
        {
            <li class="page-item">
                <a asp-action="Index"
                   asp-route-sort="@Model.ItemsSort.Current"
                   asp-route-page="@(Model.PageViewModel.SecondNextPageNumber)"
                   asp-route-selectedEmployeeIndex="@Model.ItemsFilter.SelectedEmployeeIndex"
                   asp-route-dishCount="@Model.ItemsFilter.DishCountFilter"
                   asp-route-selectedDishIndex="@Model.ItemsFilter.SelectedDishIndex"
                   asp-route-selectedPaymentTypeIndex="@Model.ItemsFilter.SelectedPaymentTypeIndex"
                   class="page-link">
                    @(Model.PageViewModel.SecondNextPageNumber)
                </a>
            </li>
        }
    </ul>
</nav>